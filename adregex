#!/system/bin/sh
#
# ${b_keyword1} ${b_keyword2} ${s_keyword} ${file_suffix}
#
#åŒå…³é”®è¯è§„åˆ™ ä¸¤ä¸ªå…³é”®è¯åŒæ—¶å‡ºç°ç”Ÿæ•ˆ
#åŒå…³é”®è¯1 ä»¥å•†å“åä¸ºä¸»
b_keyword1='å¹¿å‘Š|æœåŠ¡å™¨|cdn|é˜¿é‡Œäº‘|è…¾è®¯äº‘|é«˜é˜²|vps|ç‹¬æœ|æœç”«|å¹³å°|æ­å»º|å®šåˆ¶|å¼•æµ|å¸ç²‰|å¢ç²‰|åŠ ç²‰|å…³æ³¨|ç‚¹èµ|è¯„è®º|æ°´å†›|æ´»è·ƒ|wzç²‰|éå°å·|ä¹°å·|å–å·|å¾®ä¿¡å·|ä¼ä¸šå¾®ä¿¡|QQå·|å…¬ä¼—å·|é™Œé™Œå·|ç”µå•†|ç”µé”€|è‚¡æ°‘|èµ„æº|æ•°æ®|å°ç¾¤|åšå½©|äºšåš|æ£‹ç‰Œ|bc|è èœ|ç‹—æ¨|äººäº‹|å…¼èŒ|æ‹›è˜|æ‹›å‹Ÿ|æ‹›ä»£ç†|æš—ç½‘|é»‘äº§|ç°äº§|æ”¯ä»˜|ä»¶å¥—|è‚†ä»¶å¥—|é»‘å¡|é“¶è¡Œå¡|å¯¹å…¬|è´¦æˆ·|å…¬æˆ·|ä¸ªæˆ·|ç§æˆ·|ä»£æ”¶|ä»£ä»˜|ä»£å‘|æ´—é’±|æ¼‚ç™½|èµ„é‡‘|è½¬è´¦|usdt|å¥—ç°|æ¢æ±‡|è´·æ¬¾|ç½‘è´·|é€è´§|è·‘åˆ†|å¡å•†|å¡ç‹|æŸ¥äºº|æŸ¥è¯¢|å®šä½|å¼€æˆ¿|æŸ¥æ¡£|ç¤¾å·¥|è‹¹æœç­¾å|iOSç­¾å|ä¼ä¸šç­¾å|è†ç”°|æ‰‹è¡¨|é«˜ä»¿|æ°´é¬¼|ç§Ÿæˆ¿|æˆ¿æº|ä¸€å¯¹ä¸€|1å¯¹1'

#åŒå…³é”®è¯2 ä»¥å¯¹å•†å“çš„ä¿®é¥°ä¸ºä¸»
b_keyword2='å‡º|å”®|å–|æ”¶|éœ€è¦|å’¨è¯¢|åˆä½œ|ç‚¹æˆ‘|åŠ æˆ‘|çœ‹æˆ‘|ç‚¹å¤´åƒ|dd|æ»´æ»´|è”ç³»|ç§|vä¿¡|åŠ v|\+v|vx|åŠ q|\+q|çœŸäºº|çœŸå®|å®å|è®¤è¯|ç­›é€‰|è§£å°|æ‹…ä¿|ä¸“ä¸š|ç²¾å‡†|å®åŠ›|é«˜ç«¯|ä¸“ä¾›|ä¾›åº”|å¤§é‡|æ‰¹å‘|ç°è´§|ç°ğŸ”¥|è´§æº|ç›´å‡º|å®‰æ’|è²|å…¨æ–°|åŸè£…|ä¸€æ‰‹|äºŒæ‰‹|å›¢é˜Ÿ|å·¥ä½œå®¤'

#å•å…³é”®è¯è§„åˆ™ æ¯æ¡éƒ½æ˜¯å•ç‹¬ç”Ÿæ•ˆ
s_keyword='^(dd|æ»´æ»´|ç­¾åˆ°)$|å°å“¥å“¥.*åœ¨(ä¸åœ¨|å—)|éœ€è¦.*è”ç³»|vä¿¡|è–‡ä¿¡|^åŠ v'

#æ–‡ä»¶åç¼€è§„åˆ™ åˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶
file_suffix='exe|cmd|com|bat|scr|cpl|vbs'

#è¾“å‡ºè§„åˆ™
re_print(){
    case "$1" in
       1)
            #æ–‡ä»¶
            echo -e "\033[7;32madregex: File Suffix Rule æ–‡ä»¶åç¼€è§„åˆ™\033[0m"
            echo "(?i:\.(${file_suffix})\$)===delete"
            ;;
       2)
            #å•
            echo -e "\033[7;32madregex: Independent Rule å•å…³é”®è¯è§„åˆ™\033[0m"
            echo "(?i:(${s_keyword}))===delete"
            ;;
       4)
            #åŒ
            echo -e "\033[7;32madregex: Joint Rule åŒå…³é”®è¯è§„åˆ™\033[0m"
            echo "(?i:(${b_keyword1}).*(${b_keyword2})|(${b_keyword2}).*(${b_keyword1}))===delete"
            ;;
       8);&
       *)
            #åˆå¹¶
            echo -e "\033[7;32madregex:All in One Rule åˆå¹¶è§„åˆ™\033[0m"
            echo "(?i:(${b_keyword1}).*(${b_keyword2})|(${b_keyword2}).*(${b_keyword1})|(${s_keyword})|\.(${file_suffix})\$)===delete"
            ;;
    esac

}

help_print(){
    echo "adregx: help\nè¾“å…¥ 1 è·å–æ–‡ä»¶åç¼€è§„åˆ™\nè¾“å…¥ 2 è·å–å•å…³é”®è¯è§„åˆ™\nè¾“å…¥ 4 è·å–åŒå…³é”®è¯è§„åˆ™\nè¾“å…¥ 8 æˆ–ä»€ä¹ˆéƒ½ä¸è¾“å…¥ è·å–åˆå¹¶è§„åˆ™\nåŒæ—¶è·å–å¤šæ¡è§„åˆ™ï¼Œè¯·å°†ä»¥ä¸Šå‚æ•°ç›¸åŠ æˆ–è€…ä½¿ç”¨ç©ºæ ¼éš”å¼€"
}

err_print(){
    echo -e "\033[7;32madregex: invalid parameter value '$1'\033[0m"
}


#åˆ¤æ–­ï¼Œåˆ†ç¦»ï¼Œåˆ‡å‰²å‚æ•°
parameter_read(){
    if [ $# -eq 0 ] ;then
        re_print
    fi
    while [[ $# -ge 1 ]] ;do
        key="$1"
        case $key in
            0) re_print;;
            [1-9]);&
            [1-9][0-9])
                factor=16 # 2^4
                if [ "$key" -ge "$factor" ] ;then
                    err_print $key
                    help_print
                    error="true"
                    break
                else
                    while [ "$factor" -ge 2 ] ;do
                        factor=$((factor/2))
                        while [ "$key" -ge "$factor" ] ;do
                            let key-=$factor
                            re_print $factor
                        done
                    done
                fi
                ;;
            *help*)
                help_print
                break
                ;;
            *)
                err_print $key
                help_print
                error="true"
                break
                ;;
        esac
        shift
    done
}


parameter_read $@

#è¯·æ±‚é‡æ–°è¾“å…¥å‚æ•°
while [ "$error" == "true" ] ;do
    error="false"
    echo -n "è¯·é‡æ–°è¾“å…¥å‚æ•°ï¼Œæˆ–è¾“å…¥exité€€å‡ºï¼š"
    if read -t 60 ;then
        if [ "$REPLY" == "exit" ] ;then
            exit 0
        else
            parameter_read $REPLY
        fi
    else
        echo "è¾“å…¥è¶…æ—¶æˆ–è¢«å–æ¶ˆï¼Œè¾“å‡ºé»˜è®¤è§„åˆ™"
        re_print
    fi
done
